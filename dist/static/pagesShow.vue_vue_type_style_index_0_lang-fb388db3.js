import{a as gt,d as Dt,C as ve,D as $e,e as Ve,V as ue,I as Tt,F as Je,f as ze,g as ye,W as Bt,h as yt,U as Ce,i as Lt,j as Ie,k as vt,l as _t,m as Be,c as Ot,n as Pt,o as jt,E as Ze,B as Ut,S as Ft,N as Rt}from"./three.module-d47ac97c.js";import{f as Nt,a as zt,l as kt,x as Ht}from"./trescientos-214666d1.js";import{g as Le}from"./_commonjsHelpers-725317a4.js";import{Y as We,j as wt,ae as bt,w as Vt,o as De,c as Ge,I as ge,a9 as Qe,ak as Wt,s as Gt,B as Yt,aa as qt,U as be,a as je,ab as Kt,ac as Xt,C as $t,V as Jt,X as Zt}from"./vendor-19b019cc.js";const Qt=async()=>{const t=await Nt("./plugins/digitalCity/model/shanghai.FBX");let s=null,c=null;return t.traverse(o=>{o.name==="CITY_UNTRIANGULATED"&&(s=o),o.name==="LANDMASS"&&(c=o)}),{model:t,city:s,land:c}};function xe(d){throw new Error('Could not dynamically require "'+d+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var St={exports:{}};(function(d,t){(function(s){d.exports=s()})(function(){return function s(c,o,m){function y(C,S){if(!o[C]){if(!c[C]){var P=typeof xe=="function"&&xe;if(!S&&P)return P(C,!0);if(E)return E(C,!0);throw new Error("Cannot find module '"+C+"'")}S=o[C]={exports:{}},c[C][0].call(S.exports,function(N){var O=c[C][1][N];return y(O||N)},S,S.exports,s,c,o,m)}return o[C].exports}for(var E=typeof xe=="function"&&xe,A=0;A<m.length;A++)y(m[A]);return y}({1:[function(s,c,o){(function(m,y,E,A,C,S,P,N,O){var w=s("crypto");function B(u,g){g=I(u,g);var r;return(r=g.algorithm!=="passthrough"?w.createHash(g.algorithm):new j).write===void 0&&(r.write=r.update,r.end=r.update),x(g,r).dispatch(u),r.update||r.end(""),r.digest?r.digest(g.encoding==="buffer"?void 0:g.encoding):(u=r.read(),g.encoding!=="buffer"?u.toString(g.encoding):u)}(o=c.exports=B).sha1=function(u){return B(u)},o.keys=function(u){return B(u,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},o.MD5=function(u){return B(u,{algorithm:"md5",encoding:"hex"})},o.keysMD5=function(u){return B(u,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var h=w.getHashes?w.getHashes().slice():["sha1","md5"],M=(h.push("passthrough"),["buffer","hex","binary","base64"]);function I(u,g){var r={};if(r.algorithm=(g=g||{}).algorithm||"sha1",r.encoding=g.encoding||"hex",r.excludeValues=!!g.excludeValues,r.algorithm=r.algorithm.toLowerCase(),r.encoding=r.encoding.toLowerCase(),r.ignoreUnknown=g.ignoreUnknown===!0,r.respectType=g.respectType!==!1,r.respectFunctionNames=g.respectFunctionNames!==!1,r.respectFunctionProperties=g.respectFunctionProperties!==!1,r.unorderedArrays=g.unorderedArrays===!0,r.unorderedSets=g.unorderedSets!==!1,r.unorderedObjects=g.unorderedObjects!==!1,r.replacer=g.replacer||void 0,r.excludeKeys=g.excludeKeys||void 0,u===void 0)throw new Error("Object argument required.");for(var a=0;a<h.length;++a)h[a].toLowerCase()===r.algorithm.toLowerCase()&&(r.algorithm=h[a]);if(h.indexOf(r.algorithm)===-1)throw new Error('Algorithm "'+r.algorithm+'"  not supported. supported values: '+h.join(", "));if(M.indexOf(r.encoding)===-1&&r.algorithm!=="passthrough")throw new Error('Encoding "'+r.encoding+'"  not supported. supported values: '+M.join(", "));return r}function v(u){if(typeof u=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(u))!=null}function x(u,g,r){r=r||[];function a(n){return g.update?g.update(n,"utf8"):g.write(n,"utf8")}return{dispatch:function(n){return this["_"+((n=u.replacer?u.replacer(n):n)===null?"null":typeof n)](n)},_object:function(n){var f,p=Object.prototype.toString.call(n),z=/\[object (.*)\]/i.exec(p);if(z=(z=z?z[1]:"unknown:["+p+"]").toLowerCase(),0<=(p=r.indexOf(n)))return this.dispatch("[CIRCULAR:"+p+"]");if(r.push(n),E!==void 0&&E.isBuffer&&E.isBuffer(n))return a("buffer:"),a(n);if(z==="object"||z==="function"||z==="asyncfunction")return p=Object.keys(n),u.unorderedObjects&&(p=p.sort()),u.respectType===!1||v(n)||p.splice(0,0,"prototype","__proto__","constructor"),u.excludeKeys&&(p=p.filter(function(U){return!u.excludeKeys(U)})),a("object:"+p.length+":"),f=this,p.forEach(function(U){f.dispatch(U),a(":"),u.excludeValues||f.dispatch(n[U]),a(",")});if(!this["_"+z]){if(u.ignoreUnknown)return a("["+z+"]");throw new Error('Unknown object type "'+z+'"')}this["_"+z](n)},_array:function(n,U){U=U!==void 0?U:u.unorderedArrays!==!1;var p=this;if(a("array:"+n.length+":"),!U||n.length<=1)return n.forEach(function(k){return p.dispatch(k)});var z=[],U=n.map(function(k){var L=new j,F=r.slice();return x(u,L,F).dispatch(k),z=z.concat(F.slice(r.length)),L.read().toString()});return r=r.concat(z),U.sort(),this._array(U,!1)},_date:function(n){return a("date:"+n.toJSON())},_symbol:function(n){return a("symbol:"+n.toString())},_error:function(n){return a("error:"+n.toString())},_boolean:function(n){return a("bool:"+n.toString())},_string:function(n){a("string:"+n.length+":"),a(n.toString())},_function:function(n){a("fn:"),v(n)?this.dispatch("[native]"):this.dispatch(n.toString()),u.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(n.name)),u.respectFunctionProperties&&this._object(n)},_number:function(n){return a("number:"+n.toString())},_xml:function(n){return a("xml:"+n.toString())},_null:function(){return a("Null")},_undefined:function(){return a("Undefined")},_regexp:function(n){return a("regex:"+n.toString())},_uint8array:function(n){return a("uint8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint8clampedarray:function(n){return a("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(n))},_int8array:function(n){return a("int8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint16array:function(n){return a("uint16array:"),this.dispatch(Array.prototype.slice.call(n))},_int16array:function(n){return a("int16array:"),this.dispatch(Array.prototype.slice.call(n))},_uint32array:function(n){return a("uint32array:"),this.dispatch(Array.prototype.slice.call(n))},_int32array:function(n){return a("int32array:"),this.dispatch(Array.prototype.slice.call(n))},_float32array:function(n){return a("float32array:"),this.dispatch(Array.prototype.slice.call(n))},_float64array:function(n){return a("float64array:"),this.dispatch(Array.prototype.slice.call(n))},_arraybuffer:function(n){return a("arraybuffer:"),this.dispatch(new Uint8Array(n))},_url:function(n){return a("url:"+n.toString())},_map:function(n){return a("map:"),n=Array.from(n),this._array(n,u.unorderedSets!==!1)},_set:function(n){return a("set:"),n=Array.from(n),this._array(n,u.unorderedSets!==!1)},_file:function(n){return a("file:"),this.dispatch([n.name,n.size,n.type,n.lastModfied])},_blob:function(){if(u.ignoreUnknown)return a("[blob]");throw Error('Hashing Blob objects is currently not supported\n(see https://github.com/puleos/object-hash/issues/26)\nUse "options.replacer" or "options.ignoreUnknown"\n')},_domwindow:function(){return a("domwindow")},_bigint:function(n){return a("bigint:"+n.toString())},_process:function(){return a("process")},_timer:function(){return a("timer")},_pipe:function(){return a("pipe")},_tcp:function(){return a("tcp")},_udp:function(){return a("udp")},_tty:function(){return a("tty")},_statwatcher:function(){return a("statwatcher")},_securecontext:function(){return a("securecontext")},_connection:function(){return a("connection")},_zlib:function(){return a("zlib")},_context:function(){return a("context")},_nodescript:function(){return a("nodescript")},_httpparser:function(){return a("httpparser")},_dataview:function(){return a("dataview")},_signal:function(){return a("signal")},_fsevent:function(){return a("fsevent")},_tlswrap:function(){return a("tlswrap")}}}function j(){return{buf:"",write:function(u){this.buf+=u},end:function(u){this.buf+=u},read:function(){return this.buf}}}o.writeToStream=function(u,g,r){return r===void 0&&(r=g,g={}),x(g=I(u,g),r).dispatch(u)}}).call(this,s("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},s("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(s,c,o){(function(m,y,E,A,C,S,P,N,O){(function(w){var B=typeof Uint8Array<"u"?Uint8Array:Array,h="+".charCodeAt(0),M="/".charCodeAt(0),I="0".charCodeAt(0),v="a".charCodeAt(0),x="A".charCodeAt(0),j="-".charCodeAt(0),u="_".charCodeAt(0);function g(r){return r=r.charCodeAt(0),r===h||r===j?62:r===M||r===u?63:r<I?-1:r<I+10?r-I+26+26:r<x+26?r-x:r<v+26?r-v+26:void 0}w.toByteArray=function(r){var a,n;if(0<r.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var f=r.length,f=r.charAt(f-2)==="="?2:r.charAt(f-1)==="="?1:0,p=new B(3*r.length/4-f),z=0<f?r.length-4:r.length,U=0;function k(L){p[U++]=L}for(a=0;a<z;a+=4,0)k((16711680&(n=g(r.charAt(a))<<18|g(r.charAt(a+1))<<12|g(r.charAt(a+2))<<6|g(r.charAt(a+3))))>>16),k((65280&n)>>8),k(255&n);return f==2?k(255&(n=g(r.charAt(a))<<2|g(r.charAt(a+1))>>4)):f==1&&(k((n=g(r.charAt(a))<<10|g(r.charAt(a+1))<<4|g(r.charAt(a+2))>>2)>>8&255),k(255&n)),p},w.fromByteArray=function(r){var a,n,f,p,z=r.length%3,U="";function k(L){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(L)}for(a=0,f=r.length-z;a<f;a+=3)n=(r[a]<<16)+(r[a+1]<<8)+r[a+2],U+=k((p=n)>>18&63)+k(p>>12&63)+k(p>>6&63)+k(63&p);switch(z){case 1:U=(U+=k((n=r[r.length-1])>>2))+k(n<<4&63)+"==";break;case 2:U=(U=(U+=k((n=(r[r.length-2]<<8)+r[r.length-1])>>10))+k(n>>4&63))+k(n<<2&63)+"="}return U}})(o===void 0?this.base64js={}:o)}).call(this,s("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},s("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(s,c,o){(function(m,y,h,A,C,S,P,N,O){var w=s("base64-js"),B=s("ieee754");function h(e,i,l){if(!(this instanceof h))return new h(e,i,l);var b,_,T,H,q=typeof e;if(i==="base64"&&q=="string")for(e=(H=e).trim?H.trim():H.replace(/^\s+|\s+$/g,"");e.length%4!=0;)e+="=";if(q=="number")b=Y(e);else if(q=="string")b=h.byteLength(e,i);else{if(q!="object")throw new Error("First argument needs to be a number, array or string.");b=Y(e.length)}if(h._useTypedArrays?_=h._augment(new Uint8Array(b)):((_=this).length=b,_._isBuffer=!0),h._useTypedArrays&&typeof e.byteLength=="number")_._set(e);else if(G(H=e)||h.isBuffer(H)||H&&typeof H=="object"&&typeof H.length=="number")for(T=0;T<b;T++)h.isBuffer(e)?_[T]=e.readUInt8(T):_[T]=e[T];else if(q=="string")_.write(e,0,i);else if(q=="number"&&!h._useTypedArrays&&!l)for(T=0;T<b;T++)_[T]=0;return _}function M(e,i,l,b){return h._charsWritten=Se(function(_){for(var T=[],H=0;H<_.length;H++)T.push(255&_.charCodeAt(H));return T}(i),e,l,b)}function I(e,i,l,b){return h._charsWritten=Se(function(_){for(var T,H,q=[],X=0;X<_.length;X++)H=_.charCodeAt(X),T=H>>8,H=H%256,q.push(H),q.push(T);return q}(i),e,l,b)}function v(e,i,l){var b="";l=Math.min(e.length,l);for(var _=i;_<l;_++)b+=String.fromCharCode(e[_]);return b}function x(e,i,l,T){T||(D(typeof l=="boolean","missing or invalid endian"),D(i!=null,"missing offset"),D(i+1<e.length,"Trying to read beyond buffer length"));var _,T=e.length;if(!(T<=i))return l?(_=e[i],i+1<T&&(_|=e[i+1]<<8)):(_=e[i]<<8,i+1<T&&(_|=e[i+1])),_}function j(e,i,l,T){T||(D(typeof l=="boolean","missing or invalid endian"),D(i!=null,"missing offset"),D(i+3<e.length,"Trying to read beyond buffer length"));var _,T=e.length;if(!(T<=i))return l?(i+2<T&&(_=e[i+2]<<16),i+1<T&&(_|=e[i+1]<<8),_|=e[i],i+3<T&&(_+=e[i+3]<<24>>>0)):(i+1<T&&(_=e[i+1]<<16),i+2<T&&(_|=e[i+2]<<8),i+3<T&&(_|=e[i+3]),_+=e[i]<<24>>>0),_}function u(e,i,l,b){if(b||(D(typeof l=="boolean","missing or invalid endian"),D(i!=null,"missing offset"),D(i+1<e.length,"Trying to read beyond buffer length")),!(e.length<=i))return b=x(e,i,l,!0),32768&b?-1*(65535-b+1):b}function g(e,i,l,b){if(b||(D(typeof l=="boolean","missing or invalid endian"),D(i!=null,"missing offset"),D(i+3<e.length,"Trying to read beyond buffer length")),!(e.length<=i))return b=j(e,i,l,!0),2147483648&b?-1*(4294967295-b+1):b}function r(e,i,l,b){return b||(D(typeof l=="boolean","missing or invalid endian"),D(i+3<e.length,"Trying to read beyond buffer length")),B.read(e,i,l,23,4)}function a(e,i,l,b){return b||(D(typeof l=="boolean","missing or invalid endian"),D(i+7<e.length,"Trying to read beyond buffer length")),B.read(e,i,l,52,8)}function n(e,i,l,b,_){if(_||(D(i!=null,"missing value"),D(typeof b=="boolean","missing or invalid endian"),D(l!=null,"missing offset"),D(l+1<e.length,"trying to write beyond buffer length"),Oe(i,65535)),_=e.length,!(_<=l))for(var T=0,H=Math.min(_-l,2);T<H;T++)e[l+T]=(i&255<<8*(b?T:1-T))>>>8*(b?T:1-T)}function f(e,i,l,b,_){if(_||(D(i!=null,"missing value"),D(typeof b=="boolean","missing or invalid endian"),D(l!=null,"missing offset"),D(l+3<e.length,"trying to write beyond buffer length"),Oe(i,4294967295)),_=e.length,!(_<=l))for(var T=0,H=Math.min(_-l,4);T<H;T++)e[l+T]=i>>>8*(b?T:3-T)&255}function p(e,i,l,b,_){_||(D(i!=null,"missing value"),D(typeof b=="boolean","missing or invalid endian"),D(l!=null,"missing offset"),D(l+1<e.length,"Trying to write beyond buffer length"),Pe(i,32767,-32768)),e.length<=l||n(e,0<=i?i:65535+i+1,l,b,_)}function z(e,i,l,b,_){_||(D(i!=null,"missing value"),D(typeof b=="boolean","missing or invalid endian"),D(l!=null,"missing offset"),D(l+3<e.length,"Trying to write beyond buffer length"),Pe(i,2147483647,-2147483648)),e.length<=l||f(e,0<=i?i:4294967295+i+1,l,b,_)}function U(e,i,l,b,_){_||(D(i!=null,"missing value"),D(typeof b=="boolean","missing or invalid endian"),D(l!=null,"missing offset"),D(l+3<e.length,"Trying to write beyond buffer length"),Ke(i,34028234663852886e22,-34028234663852886e22)),e.length<=l||B.write(e,i,l,b,23,4)}function k(e,i,l,b,_){_||(D(i!=null,"missing value"),D(typeof b=="boolean","missing or invalid endian"),D(l!=null,"missing offset"),D(l+7<e.length,"Trying to write beyond buffer length"),Ke(i,17976931348623157e292,-17976931348623157e292)),e.length<=l||B.write(e,i,l,b,52,8)}o.Buffer=h,o.SlowBuffer=h,o.INSPECT_MAX_BYTES=50,h.poolSize=8192,h._useTypedArrays=function(){try{var e=new ArrayBuffer(0),i=new Uint8Array(e);return i.foo=function(){return 42},i.foo()===42&&typeof i.subarray=="function"}catch(l){return!1}}(),h.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.isBuffer=function(e){return!(e==null||!e._isBuffer)},h.byteLength=function(e,i){var l;switch(e+="",i||"utf8"){case"hex":l=e.length/2;break;case"utf8":case"utf-8":l=ce(e).length;break;case"ascii":case"binary":case"raw":l=e.length;break;case"base64":l=Ye(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":l=2*e.length;break;default:throw new Error("Unknown encoding")}return l},h.concat=function(e,i){if(D(G(e),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),e.length===0)return new h(0);if(e.length===1)return e[0];if(typeof i!="number")for(_=i=0;_<e.length;_++)i+=e[_].length;for(var l=new h(i),b=0,_=0;_<e.length;_++){var T=e[_];T.copy(l,b),b+=T.length}return l},h.prototype.write=function(e,i,l,b){isFinite(i)?isFinite(l)||(b=l,l=void 0):(X=b,b=i,i=l,l=X),i=Number(i)||0;var _,T,H,q,X=this.length-i;switch((!l||X<(l=Number(l)))&&(l=X),b=String(b||"utf8").toLowerCase()){case"hex":_=function(ie,ee,te,$){te=Number(te)||0;var K=ie.length-te;(!$||K<($=Number($)))&&($=K),D((K=ee.length)%2==0,"Invalid hex string"),K/2<$&&($=K/2);for(var pe=0;pe<$;pe++){var Xe=parseInt(ee.substr(2*pe,2),16);D(!isNaN(Xe),"Invalid hex string"),ie[te+pe]=Xe}return h._charsWritten=2*pe,pe}(this,e,i,l);break;case"utf8":case"utf-8":T=this,H=i,q=l,_=h._charsWritten=Se(ce(e),T,H,q);break;case"ascii":case"binary":_=M(this,e,i,l);break;case"base64":T=this,H=i,q=l,_=h._charsWritten=Se(Ye(e),T,H,q);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":_=I(this,e,i,l);break;default:throw new Error("Unknown encoding")}return _},h.prototype.toString=function(e,i,l){var b,_,T,H,q=this;if(e=String(e||"utf8").toLowerCase(),i=Number(i)||0,(l=l!==void 0?Number(l):q.length)===i)return"";switch(e){case"hex":b=function(X,ie,ee){var te=X.length;(!ie||ie<0)&&(ie=0),(!ee||ee<0||te<ee)&&(ee=te);for(var $="",K=ie;K<ee;K++)$+=V(X[K]);return $}(q,i,l);break;case"utf8":case"utf-8":b=function(X,ie,ee){var te="",$="";ee=Math.min(X.length,ee);for(var K=ie;K<ee;K++)X[K]<=127?(te+=qe($)+String.fromCharCode(X[K]),$=""):$+="%"+X[K].toString(16);return te+qe($)}(q,i,l);break;case"ascii":case"binary":b=v(q,i,l);break;case"base64":_=q,H=l,b=(T=i)===0&&H===_.length?w.fromByteArray(_):w.fromByteArray(_.slice(T,H));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":b=function(X,ie,ee){for(var te=X.slice(ie,ee),$="",K=0;K<te.length;K+=2)$+=String.fromCharCode(te[K]+256*te[K+1]);return $}(q,i,l);break;default:throw new Error("Unknown encoding")}return b},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},h.prototype.copy=function(e,i,l,b){if(i=i||0,(b=b||b===0?b:this.length)!==(l=l||0)&&e.length!==0&&this.length!==0){D(l<=b,"sourceEnd < sourceStart"),D(0<=i&&i<e.length,"targetStart out of bounds"),D(0<=l&&l<this.length,"sourceStart out of bounds"),D(0<=b&&b<=this.length,"sourceEnd out of bounds"),b>this.length&&(b=this.length);var _=(b=e.length-i<b-l?e.length-i+l:b)-l;if(_<100||!h._useTypedArrays)for(var T=0;T<_;T++)e[T+i]=this[T+l];else e._set(this.subarray(l,l+_),i)}},h.prototype.slice=function(e,i){var l=this.length;if(e=F(e,l,0),i=F(i,l,l),h._useTypedArrays)return h._augment(this.subarray(e,i));for(var b=i-e,_=new h(b,void 0,!0),T=0;T<b;T++)_[T]=this[T+e];return _},h.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},h.prototype.set=function(e,i){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,i)},h.prototype.readUInt8=function(e,i){if(i||(D(e!=null,"missing offset"),D(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return this[e]},h.prototype.readUInt16LE=function(e,i){return x(this,e,!0,i)},h.prototype.readUInt16BE=function(e,i){return x(this,e,!1,i)},h.prototype.readUInt32LE=function(e,i){return j(this,e,!0,i)},h.prototype.readUInt32BE=function(e,i){return j(this,e,!1,i)},h.prototype.readInt8=function(e,i){if(i||(D(e!=null,"missing offset"),D(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return 128&this[e]?-1*(255-this[e]+1):this[e]},h.prototype.readInt16LE=function(e,i){return u(this,e,!0,i)},h.prototype.readInt16BE=function(e,i){return u(this,e,!1,i)},h.prototype.readInt32LE=function(e,i){return g(this,e,!0,i)},h.prototype.readInt32BE=function(e,i){return g(this,e,!1,i)},h.prototype.readFloatLE=function(e,i){return r(this,e,!0,i)},h.prototype.readFloatBE=function(e,i){return r(this,e,!1,i)},h.prototype.readDoubleLE=function(e,i){return a(this,e,!0,i)},h.prototype.readDoubleBE=function(e,i){return a(this,e,!1,i)},h.prototype.writeUInt8=function(e,i,l){l||(D(e!=null,"missing value"),D(i!=null,"missing offset"),D(i<this.length,"trying to write beyond buffer length"),Oe(e,255)),i>=this.length||(this[i]=e)},h.prototype.writeUInt16LE=function(e,i,l){n(this,e,i,!0,l)},h.prototype.writeUInt16BE=function(e,i,l){n(this,e,i,!1,l)},h.prototype.writeUInt32LE=function(e,i,l){f(this,e,i,!0,l)},h.prototype.writeUInt32BE=function(e,i,l){f(this,e,i,!1,l)},h.prototype.writeInt8=function(e,i,l){l||(D(e!=null,"missing value"),D(i!=null,"missing offset"),D(i<this.length,"Trying to write beyond buffer length"),Pe(e,127,-128)),i>=this.length||(0<=e?this.writeUInt8(e,i,l):this.writeUInt8(255+e+1,i,l))},h.prototype.writeInt16LE=function(e,i,l){p(this,e,i,!0,l)},h.prototype.writeInt16BE=function(e,i,l){p(this,e,i,!1,l)},h.prototype.writeInt32LE=function(e,i,l){z(this,e,i,!0,l)},h.prototype.writeInt32BE=function(e,i,l){z(this,e,i,!1,l)},h.prototype.writeFloatLE=function(e,i,l){U(this,e,i,!0,l)},h.prototype.writeFloatBE=function(e,i,l){U(this,e,i,!1,l)},h.prototype.writeDoubleLE=function(e,i,l){k(this,e,i,!0,l)},h.prototype.writeDoubleBE=function(e,i,l){k(this,e,i,!1,l)},h.prototype.fill=function(e,i,l){if(i=i||0,l=l||this.length,D(typeof(e=typeof(e=e||0)=="string"?e.charCodeAt(0):e)=="number"&&!isNaN(e),"value is not a number"),D(i<=l,"end < start"),l!==i&&this.length!==0){D(0<=i&&i<this.length,"start out of bounds"),D(0<=l&&l<=this.length,"end out of bounds");for(var b=i;b<l;b++)this[b]=e}},h.prototype.inspect=function(){for(var e=[],i=this.length,l=0;l<i;l++)if(e[l]=V(this[l]),l===o.INSPECT_MAX_BYTES){e[l+1]="...";break}return"<Buffer "+e.join(" ")+">"},h.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(h._useTypedArrays)return new h(this).buffer;for(var e=new Uint8Array(this.length),i=0,l=e.length;i<l;i+=1)e[i]=this[i];return e.buffer};var L=h.prototype;function F(e,i,l){return typeof e!="number"?l:i<=(e=~~e)?i:0<=e||0<=(e+=i)?e:0}function Y(e){return(e=~~Math.ceil(+e))<0?0:e}function G(e){return(Array.isArray||function(i){return Object.prototype.toString.call(i)==="[object Array]"})(e)}function V(e){return e<16?"0"+e.toString(16):e.toString(16)}function ce(e){for(var i=[],l=0;l<e.length;l++){var b=e.charCodeAt(l);if(b<=127)i.push(e.charCodeAt(l));else for(var _=l,T=(55296<=b&&b<=57343&&l++,encodeURIComponent(e.slice(_,l+1)).substr(1).split("%")),H=0;H<T.length;H++)i.push(parseInt(T[H],16))}return i}function Ye(e){return w.toByteArray(e)}function Se(e,i,l,b){for(var _=0;_<b&&!(_+l>=i.length||_>=e.length);_++)i[_+l]=e[_];return _}function qe(e){try{return decodeURIComponent(e)}catch(i){return String.fromCharCode(65533)}}function Oe(e,i){D(typeof e=="number","cannot write a non-number as a number"),D(0<=e,"specified a negative value for writing an unsigned value"),D(e<=i,"value is larger than maximum value for type"),D(Math.floor(e)===e,"value has a fractional component")}function Pe(e,i,l){D(typeof e=="number","cannot write a non-number as a number"),D(e<=i,"value larger than maximum allowed value"),D(l<=e,"value smaller than minimum allowed value"),D(Math.floor(e)===e,"value has a fractional component")}function Ke(e,i,l){D(typeof e=="number","cannot write a non-number as a number"),D(e<=i,"value larger than maximum allowed value"),D(l<=e,"value smaller than minimum allowed value")}function D(e,i){if(!e)throw new Error(i||"Failed assertion")}h._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=L.get,e.set=L.set,e.write=L.write,e.toString=L.toString,e.toLocaleString=L.toString,e.toJSON=L.toJSON,e.copy=L.copy,e.slice=L.slice,e.readUInt8=L.readUInt8,e.readUInt16LE=L.readUInt16LE,e.readUInt16BE=L.readUInt16BE,e.readUInt32LE=L.readUInt32LE,e.readUInt32BE=L.readUInt32BE,e.readInt8=L.readInt8,e.readInt16LE=L.readInt16LE,e.readInt16BE=L.readInt16BE,e.readInt32LE=L.readInt32LE,e.readInt32BE=L.readInt32BE,e.readFloatLE=L.readFloatLE,e.readFloatBE=L.readFloatBE,e.readDoubleLE=L.readDoubleLE,e.readDoubleBE=L.readDoubleBE,e.writeUInt8=L.writeUInt8,e.writeUInt16LE=L.writeUInt16LE,e.writeUInt16BE=L.writeUInt16BE,e.writeUInt32LE=L.writeUInt32LE,e.writeUInt32BE=L.writeUInt32BE,e.writeInt8=L.writeInt8,e.writeInt16LE=L.writeInt16LE,e.writeInt16BE=L.writeInt16BE,e.writeInt32LE=L.writeInt32LE,e.writeInt32BE=L.writeInt32BE,e.writeFloatLE=L.writeFloatLE,e.writeFloatBE=L.writeFloatBE,e.writeDoubleLE=L.writeDoubleLE,e.writeDoubleBE=L.writeDoubleBE,e.fill=L.fill,e.inspect=L.inspect,e.toArrayBuffer=L.toArrayBuffer,e}}).call(this,s("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},s("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(s,c,o){(function(m,y,w,A,C,S,P,N,O){var w=s("buffer").Buffer,B=4,h=new w(B);h.fill(0),c.exports={hash:function(M,I,v,x){for(var j=I(function(n,f){n.length%B!=0&&(p=n.length+(B-n.length%B),n=w.concat([n,h],p));for(var p,z=[],U=f?n.readInt32BE:n.readInt32LE,k=0;k<n.length;k+=B)z.push(U.call(n,k));return z}(M=w.isBuffer(M)?M:new w(M),x),8*M.length),I=x,u=new w(v),g=I?u.writeInt32BE:u.writeInt32LE,r=0;r<j.length;r++)g.call(u,j[r],4*r,!0);return u}}}).call(this,s("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},s("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(s,c,o){(function(m,y,w,A,C,S,P,N,O){var w=s("buffer").Buffer,B=s("./sha"),h=s("./sha256"),M=s("./rng"),I={sha1:B,sha256:h,md5:s("./md5")},v=64,x=new w(v);function j(n,f){var p=I[n=n||"sha1"],z=[];return p||u("algorithm:",n,"is not yet supported"),{update:function(U){return w.isBuffer(U)||(U=new w(U)),z.push(U),U.length,this},digest:function(U){var k=w.concat(z),k=f?function(L,F,Y){w.isBuffer(F)||(F=new w(F)),w.isBuffer(Y)||(Y=new w(Y)),F.length>v?F=L(F):F.length<v&&(F=w.concat([F,x],v));for(var G=new w(v),V=new w(v),ce=0;ce<v;ce++)G[ce]=54^F[ce],V[ce]=92^F[ce];return Y=L(w.concat([G,Y])),L(w.concat([V,Y]))}(p,f,k):p(k);return z=null,U?k.toString(U):k}}}function u(){var n=[].slice.call(arguments).join(" ");throw new Error([n,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}x.fill(0),o.createHash=function(n){return j(n)},o.createHmac=j,o.randomBytes=function(n,f){if(!f||!f.call)return new w(M(n));try{f.call(this,void 0,new w(M(n)))}catch(p){f(p)}};var g,r=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],a=function(n){o[n]=function(){u("sorry,",n,"is not implemented yet")}};for(g in r)a(r[g])}).call(this,s("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},s("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(s,c,o){(function(m,y,E,A,C,S,P,N,O){var w=s("./helpers");function B(u,g){u[g>>5]|=128<<g%32,u[14+(g+64>>>9<<4)]=g;for(var r=1732584193,a=-271733879,n=-1732584194,f=271733878,p=0;p<u.length;p+=16){var z=r,U=a,k=n,L=f,r=M(r,a,n,f,u[p+0],7,-680876936),f=M(f,r,a,n,u[p+1],12,-389564586),n=M(n,f,r,a,u[p+2],17,606105819),a=M(a,n,f,r,u[p+3],22,-1044525330);r=M(r,a,n,f,u[p+4],7,-176418897),f=M(f,r,a,n,u[p+5],12,1200080426),n=M(n,f,r,a,u[p+6],17,-1473231341),a=M(a,n,f,r,u[p+7],22,-45705983),r=M(r,a,n,f,u[p+8],7,1770035416),f=M(f,r,a,n,u[p+9],12,-1958414417),n=M(n,f,r,a,u[p+10],17,-42063),a=M(a,n,f,r,u[p+11],22,-1990404162),r=M(r,a,n,f,u[p+12],7,1804603682),f=M(f,r,a,n,u[p+13],12,-40341101),n=M(n,f,r,a,u[p+14],17,-1502002290),r=I(r,a=M(a,n,f,r,u[p+15],22,1236535329),n,f,u[p+1],5,-165796510),f=I(f,r,a,n,u[p+6],9,-1069501632),n=I(n,f,r,a,u[p+11],14,643717713),a=I(a,n,f,r,u[p+0],20,-373897302),r=I(r,a,n,f,u[p+5],5,-701558691),f=I(f,r,a,n,u[p+10],9,38016083),n=I(n,f,r,a,u[p+15],14,-660478335),a=I(a,n,f,r,u[p+4],20,-405537848),r=I(r,a,n,f,u[p+9],5,568446438),f=I(f,r,a,n,u[p+14],9,-1019803690),n=I(n,f,r,a,u[p+3],14,-187363961),a=I(a,n,f,r,u[p+8],20,1163531501),r=I(r,a,n,f,u[p+13],5,-1444681467),f=I(f,r,a,n,u[p+2],9,-51403784),n=I(n,f,r,a,u[p+7],14,1735328473),r=v(r,a=I(a,n,f,r,u[p+12],20,-1926607734),n,f,u[p+5],4,-378558),f=v(f,r,a,n,u[p+8],11,-2022574463),n=v(n,f,r,a,u[p+11],16,1839030562),a=v(a,n,f,r,u[p+14],23,-35309556),r=v(r,a,n,f,u[p+1],4,-1530992060),f=v(f,r,a,n,u[p+4],11,1272893353),n=v(n,f,r,a,u[p+7],16,-155497632),a=v(a,n,f,r,u[p+10],23,-1094730640),r=v(r,a,n,f,u[p+13],4,681279174),f=v(f,r,a,n,u[p+0],11,-358537222),n=v(n,f,r,a,u[p+3],16,-722521979),a=v(a,n,f,r,u[p+6],23,76029189),r=v(r,a,n,f,u[p+9],4,-640364487),f=v(f,r,a,n,u[p+12],11,-421815835),n=v(n,f,r,a,u[p+15],16,530742520),r=x(r,a=v(a,n,f,r,u[p+2],23,-995338651),n,f,u[p+0],6,-198630844),f=x(f,r,a,n,u[p+7],10,1126891415),n=x(n,f,r,a,u[p+14],15,-1416354905),a=x(a,n,f,r,u[p+5],21,-57434055),r=x(r,a,n,f,u[p+12],6,1700485571),f=x(f,r,a,n,u[p+3],10,-1894986606),n=x(n,f,r,a,u[p+10],15,-1051523),a=x(a,n,f,r,u[p+1],21,-2054922799),r=x(r,a,n,f,u[p+8],6,1873313359),f=x(f,r,a,n,u[p+15],10,-30611744),n=x(n,f,r,a,u[p+6],15,-1560198380),a=x(a,n,f,r,u[p+13],21,1309151649),r=x(r,a,n,f,u[p+4],6,-145523070),f=x(f,r,a,n,u[p+11],10,-1120210379),n=x(n,f,r,a,u[p+2],15,718787259),a=x(a,n,f,r,u[p+9],21,-343485551),r=j(r,z),a=j(a,U),n=j(n,k),f=j(f,L)}return Array(r,a,n,f)}function h(u,g,r,a,n,f){return j((g=j(j(g,u),j(a,f)))<<n|g>>>32-n,r)}function M(u,g,r,a,n,f,p){return h(g&r|~g&a,u,g,n,f,p)}function I(u,g,r,a,n,f,p){return h(g&a|r&~a,u,g,n,f,p)}function v(u,g,r,a,n,f,p){return h(g^r^a,u,g,n,f,p)}function x(u,g,r,a,n,f,p){return h(r^(g|~a),u,g,n,f,p)}function j(u,g){var r=(65535&u)+(65535&g);return(u>>16)+(g>>16)+(r>>16)<<16|65535&r}c.exports=function(u){return w.hash(u,B,16)}}).call(this,s("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},s("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(s,c,o){(function(m,y,E,A,C,S,P,N,O){c.exports=function(w){for(var B,h=new Array(w),M=0;M<w;M++)!(3&M)&&(B=4294967296*Math.random()),h[M]=B>>>((3&M)<<3)&255;return h}}).call(this,s("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},s("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(s,c,o){(function(m,y,E,A,C,S,P,N,O){var w=s("./helpers");function B(I,v){I[v>>5]|=128<<24-v%32,I[15+(v+64>>9<<4)]=v;for(var x,j,u,g=Array(80),r=1732584193,a=-271733879,n=-1732584194,f=271733878,p=-1009589776,z=0;z<I.length;z+=16){for(var U=r,k=a,L=n,F=f,Y=p,G=0;G<80;G++){g[G]=G<16?I[z+G]:M(g[G-3]^g[G-8]^g[G-14]^g[G-16],1);var V=h(h(M(r,5),(V=a,j=n,u=f,(x=G)<20?V&j|~V&u:!(x<40)&&x<60?V&j|V&u|j&u:V^j^u)),h(h(p,g[G]),(x=G)<20?1518500249:x<40?1859775393:x<60?-1894007588:-899497514)),p=f,f=n,n=M(a,30),a=r,r=V}r=h(r,U),a=h(a,k),n=h(n,L),f=h(f,F),p=h(p,Y)}return Array(r,a,n,f,p)}function h(I,v){var x=(65535&I)+(65535&v);return(I>>16)+(v>>16)+(x>>16)<<16|65535&x}function M(I,v){return I<<v|I>>>32-v}c.exports=function(I){return w.hash(I,B,20,!0)}}).call(this,s("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},s("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(s,c,o){(function(m,y,E,A,C,S,P,N,O){function w(v,x){var j=(65535&v)+(65535&x);return(v>>16)+(x>>16)+(j>>16)<<16|65535&j}function B(v,x){var j,u=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),g=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),r=new Array(64);v[x>>5]|=128<<24-x%32,v[15+(x+64>>9<<4)]=x;for(var a,n,f=0;f<v.length;f+=16){for(var p=g[0],z=g[1],U=g[2],k=g[3],L=g[4],F=g[5],Y=g[6],G=g[7],V=0;V<64;V++)r[V]=V<16?v[V+f]:w(w(w((n=r[V-2],M(n,17)^M(n,19)^I(n,10)),r[V-7]),(n=r[V-15],M(n,7)^M(n,18)^I(n,3))),r[V-16]),j=w(w(w(w(G,M(n=L,6)^M(n,11)^M(n,25)),L&F^~L&Y),u[V]),r[V]),a=w(M(a=p,2)^M(a,13)^M(a,22),p&z^p&U^z&U),G=Y,Y=F,F=L,L=w(k,j),k=U,U=z,z=p,p=w(j,a);g[0]=w(p,g[0]),g[1]=w(z,g[1]),g[2]=w(U,g[2]),g[3]=w(k,g[3]),g[4]=w(L,g[4]),g[5]=w(F,g[5]),g[6]=w(Y,g[6]),g[7]=w(G,g[7])}return g}var h=s("./helpers"),M=function(v,x){return v>>>x|v<<32-x},I=function(v,x){return v>>>x};c.exports=function(v){return h.hash(v,B,32,!0)}}).call(this,s("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},s("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(s,c,o){(function(m,y,E,A,C,S,P,N,O){o.read=function(w,B,h,M,f){var v,x,j=8*f-M-1,u=(1<<j)-1,g=u>>1,r=-7,a=h?f-1:0,n=h?-1:1,f=w[B+a];for(a+=n,v=f&(1<<-r)-1,f>>=-r,r+=j;0<r;v=256*v+w[B+a],a+=n,r-=8);for(x=v&(1<<-r)-1,v>>=-r,r+=M;0<r;x=256*x+w[B+a],a+=n,r-=8);if(v===0)v=1-g;else{if(v===u)return x?NaN:1/0*(f?-1:1);x+=Math.pow(2,M),v-=g}return(f?-1:1)*x*Math.pow(2,v-M)},o.write=function(w,B,h,M,I,p){var x,j,u=8*p-I-1,g=(1<<u)-1,r=g>>1,a=I===23?Math.pow(2,-24)-Math.pow(2,-77):0,n=M?0:p-1,f=M?1:-1,p=B<0||B===0&&1/B<0?1:0;for(B=Math.abs(B),isNaN(B)||B===1/0?(j=isNaN(B)?1:0,x=g):(x=Math.floor(Math.log(B)/Math.LN2),B*(M=Math.pow(2,-x))<1&&(x--,M*=2),2<=(B+=1<=x+r?a/M:a*Math.pow(2,1-r))*M&&(x++,M/=2),g<=x+r?(j=0,x=g):1<=x+r?(j=(B*M-1)*Math.pow(2,I),x+=r):(j=B*Math.pow(2,r-1)*Math.pow(2,I),x=0));8<=I;w[h+n]=255&j,n+=f,j/=256,I-=8);for(x=x<<I|j,u+=I;0<u;w[h+n]=255&x,n+=f,x/=256,u-=8);w[h+n-f]|=128*p}}).call(this,s("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},s("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(s,c,o){(function(m,y,E,A,C,S,P,N,O){var w,B,h;function M(){}(m=c.exports={}).nextTick=(B=typeof window<"u"&&window.setImmediate,h=typeof window<"u"&&window.postMessage&&window.addEventListener,B?function(I){return window.setImmediate(I)}:h?(w=[],window.addEventListener("message",function(I){var v=I.source;v!==window&&v!==null||I.data!=="process-tick"||(I.stopPropagation(),0<w.length&&w.shift()())},!0),function(I){w.push(I),window.postMessage("process-tick","*")}):function(I){setTimeout(I,0)}),m.title="browser",m.browser=!0,m.env={},m.argv=[],m.on=M,m.addListener=M,m.once=M,m.off=M,m.removeListener=M,m.removeAllListeners=M,m.emit=M,m.binding=function(I){throw new Error("process.binding is not supported")},m.cwd=function(){return"/"},m.chdir=function(I){throw new Error("process.chdir is not supported")}}).call(this,s("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},s("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)})})(St);var en=St.exports;const tn=Le(en);var xt=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"],nn=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"],Mt=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"],rn=xt,on=rn.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"]),ke=Mt;ke=ke.slice().filter(function(d){return!/^(gl\_|texture)/.test(d)});var an=ke.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"]),sn=yn,ln=xt,et=nn,cn=Mt,un=on,fn=an,oe=999,tt=9999,Ue=0,Fe=1,nt=2,rt=3,it=4,_e=5,dn=6,pn=7,hn=8,ot=9,mn=10,at=11,gn=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];function yn(d){var t=0,s=0,c=oe,o,m,y=[],E=[],A=1,C=0,S=0,P=!1,N=!1,O="",w;d=d||{};var B=cn,h=ln;d.version==="300 es"&&(B=fn,h=un);for(var M={},I={},t=0;t<B.length;t++)M[B[t]]=!0;for(var t=0;t<h.length;t++)I[h[t]]=!0;return function(F){return E=[],F!==null?x(F):j()};function v(F){F.length&&E.push({type:gn[c],data:F,position:S,line:A,column:C})}function x(F){t=0,F.toString&&(F=F.toString()),O+=F.replace(/\r\n/g,"\n"),w=O.length;for(var Y;o=O[t],t<w;){switch(Y=t,c){case Ue:t=n();break;case Fe:t=a();break;case nt:t=r();break;case rt:t=f();break;case it:t=U();break;case at:t=z();break;case _e:t=k();break;case tt:t=L();break;case ot:t=g();break;case oe:t=u();break}if(Y!==t)switch(O[Y]){case"\n":C=0,++A;break;default:++C;break}}return s+=t,O=O.slice(t),E}function j(F){return y.length&&v(y.join("")),c=mn,v("(eof)"),E}function u(){return y=y.length?[]:y,m==="/"&&o==="*"?(S=s+t-1,c=Ue,m=o,t+1):m==="/"&&o==="/"?(S=s+t-1,c=Fe,m=o,t+1):o==="#"?(c=nt,S=s+t,t):/\s/.test(o)?(c=ot,S=s+t,t):(P=/\d/.test(o),N=/[^\w_]/.test(o),S=s+t,c=P?it:N?rt:tt,t)}function g(){return/[^\s]/g.test(o)?(v(y.join("")),c=oe,t):(y.push(o),m=o,t+1)}function r(){return(o==="\r"||o==="\n")&&m!=="\\"?(v(y.join("")),c=oe,t):(y.push(o),m=o,t+1)}function a(){return r()}function n(){return o==="/"&&m==="*"?(y.push(o),v(y.join("")),c=oe,t+1):(y.push(o),m=o,t+1)}function f(){if(m==="."&&/\d/.test(o))return c=_e,t;if(m==="/"&&o==="*")return c=Ue,t;if(m==="/"&&o==="/")return c=Fe,t;if(o==="."&&y.length){for(;p(y););return c=_e,t}if(o===";"||o===")"||o==="("){if(y.length)for(;p(y););return v(o),c=oe,t+1}var F=y.length===2&&o!=="=";if(/[\w_\d\s]/.test(o)||F){for(;p(y););return c=oe,t}return y.push(o),m=o,t+1}function p(F){var Y=0,G,V;do{if(G=et.indexOf(F.slice(0,F.length+Y).join("")),V=et[G],G===-1){if(Y--+F.length>0)continue;V=F.slice(0,1).join("")}return v(V),S+=V.length,y=y.slice(V.length),y.length}while(1)}function z(){return/[^a-fA-F0-9]/.test(o)?(v(y.join("")),c=oe,t):(y.push(o),m=o,t+1)}function U(){return o==="."||/[eE]/.test(o)?(y.push(o),c=_e,m=o,t+1):o==="x"&&y.length===1&&y[0]==="0"?(c=at,y.push(o),m=o,t+1):/[^\d]/.test(o)?(v(y.join("")),c=oe,t):(y.push(o),m=o,t+1)}function k(){return o==="f"&&(y.push(o),m=o,t+=1),/[eE]/.test(o)||(o==="-"||o==="+")&&/[eE]/.test(m)?(y.push(o),m=o,t+1):/[^\d]/.test(o)?(v(y.join("")),c=oe,t):(y.push(o),m=o,t+1)}function L(){if(/[^\d\w_]/.test(o)){var F=y.join("");return I[F]?c=hn:M[F]?c=pn:c=dn,v(y.join("")),c=oe,t}return y.push(o),m=o,t+1}}var vn=sn,_n=wn;function wn(d,t){var s=vn(t),c=[];return c=c.concat(s(d)),c=c.concat(s(null)),c}const bn=Le(_n);var Sn=xn;function xn(d){for(var t=[],s=0;s<d.length;s++)d[s].type!=="eof"&&t.push(d[s].data);return t.join("")}const st=Le(Sn);var Mn=En;function En(d){var t=null,s=null,c=0,o=0,m=0,y=0,E=0,A=[],C,S,P;for(C=0,S;C<d.length;C++)if(P=d[C],P.data==="{"){if(c&&c++||(S=O(C,fe(")"),fe()),S<0)||(y=S,S=O(S,fe("("),fe(")")),S<0)||(E=S,S=O(S,we),S<0)||d[S].type!=="ident"||(s=d[S].data,S=O(S,we),S<0))continue;c=1,o=C,t=d[S].data,m=S;var N=O(S,we);switch(d[N]&&d[N].data){case"lowp":case"highp":case"mediump":m=N}}else if(c&&P.data==="}"){if(--c)continue;A.push({name:s,type:t,body:[o+1,C],args:[E,y+1],outer:[m,C+1]})}for(C=0;C<d.length;C++)if(P=d[C],P.data===";"){if(S=O(C,fe(")"),fe()),S<0||(y=S,S=O(S,fe("("),fe(")")),S<0)||(E=S,S=O(S,we),S<0)||d[S].type!=="ident"||(s=d[S].data,S=O(S,we),S<0)||d[S].type==="operator"||d[S].data==="return")continue;t=d[S].data,A.push({name:s,type:t,body:!1,args:[E,y+1],outer:[S,C+1]})}return A.sort(function(w,B){return w.outer[0]-B.outer[0]});function O(w,B,h){for(var M=w-1;M>=0;M--){if(B(d[M]))return M;if(h&&h(d[M]))return-1}return-1}}function fe(d){return function(t){return t.type==="operator"&&(!d||t.data===d)}}function we(d){return d.type!=="whitespace"}const An=Le(Mn);function Cn(d,t){if(typeof d!="object"||d===null)return d;var s=d[Symbol.toPrimitive];if(s!==void 0){var c=s.call(d,t||"default");if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(d)}function Et(d){var t=Cn(d,"string");return typeof t=="symbol"?t:String(t)}function W(d,t,s){return t=Et(t),t in d?Object.defineProperty(d,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):d[t]=s,d}function lt(d,t){var s=Object.keys(d);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(d);t&&(c=c.filter(function(o){return Object.getOwnPropertyDescriptor(d,o).enumerable})),s.push.apply(s,c)}return s}function he(d){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?arguments[t]:{};t%2?lt(Object(s),!0).forEach(function(c){W(d,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(s)):lt(Object(s)).forEach(function(c){Object.defineProperty(d,c,Object.getOwnPropertyDescriptor(s,c))})}return d}function In(d,t){if(d==null)return{};var s={},c=Object.keys(d),o,m;for(m=0;m<c.length;m++)o=c[m],!(t.indexOf(o)>=0)&&(s[o]=d[o]);return s}function Dn(d,t){if(d==null)return{};var s=In(d,t),c,o;if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(d);for(o=0;o<m.length;o++)c=m[o],!(t.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(d,c)&&(s[c]=d[c])}return s}function Tn(d,t){if(!(d instanceof t))throw new TypeError("Cannot call a class as a function")}function ct(d,t){for(var s=0;s<t.length;s++){var c=t[s];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(d,Et(c.key),c)}}function Bn(d,t,s){return t&&ct(d.prototype,t),s&&ct(d,s),Object.defineProperty(d,"prototype",{writable:!1}),d}function At(d){if(d===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d}function He(d,t){return He=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(c,o){return c.__proto__=o,c},He(d,t)}function Ln(d,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");d.prototype=Object.create(t&&t.prototype,{constructor:{value:d,writable:!0,configurable:!0}}),Object.defineProperty(d,"prototype",{writable:!1}),t&&He(d,t)}function Te(d){return Te=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},Te(d)}function On(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(d){return!1}}function Pn(d,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return At(d)}function jn(d){var t=On();return function(){var c=Te(d),o;if(t){var m=Te(this).constructor;o=Reflect.construct(c,arguments,m)}else o=c.apply(this,arguments);return Pn(this,o)}}var R={position:"csm_Position",positionRaw:"csm_PositionRaw",pointSize:"csm_PointSize",fragColor:"csm_FragColor",diffuseColor:"csm_DiffuseColor",normal:"csm_Normal",roughness:"csm_Roughness",metalness:"csm_Metalness",emissive:"csm_Emissive",ao:"csm_AO",bump:"csm_Bump",depthAlpha:"csm_DepthAlpha"},ne,me,Un=(ne={},W(ne,"".concat(R.normal),{"#include <beginnormal_vertex>":"\n    vec3 objectNormal = ".concat(R.normal,";\n    #ifdef USE_TANGENT\n	    vec3 objectTangent = vec3( tangent.xyz );\n    #endif\n    ")}),W(ne,"".concat(R.position),{"#include <begin_vertex>":"\n    vec3 transformed = ".concat(R.position,";\n  ")}),W(ne,"".concat(R.positionRaw),{"#include <begin_vertex>":"\n    vec4 csm_internal_positionUnprojected = ".concat(R.positionRaw,";\n    mat4x4 csm_internal_unprojectMatrix = projectionMatrix * modelViewMatrix;\n    #ifdef USE_INSTANCING\n      csm_internal_unprojectMatrix = csm_internal_unprojectMatrix * instanceMatrix;\n    #endif\n    csm_internal_positionUnprojected = inverse(csm_internal_unprojectMatrix) * csm_internal_positionUnprojected;\n    vec3 transformed = csm_internal_positionUnprojected.xyz;\n  ")}),W(ne,"".concat(R.pointSize),{"gl_PointSize = size;":"\n    gl_PointSize = ".concat(R.pointSize,";\n    ")}),W(ne,"".concat(R.diffuseColor),{"#include <color_fragment>":"\n    #include <color_fragment>\n    diffuseColor = ".concat(R.diffuseColor,";\n  ")}),W(ne,"".concat(R.fragColor),{"#include <dithering_fragment>":"\n    #include <dithering_fragment>\n    gl_FragColor  = ".concat(R.fragColor,";\n  ")}),W(ne,"".concat(R.emissive),{"vec3 totalEmissiveRadiance = emissive;":"\n    vec3 totalEmissiveRadiance = ".concat(R.emissive,";\n    ")}),W(ne,"".concat(R.roughness),{"#include <roughnessmap_fragment>":"\n    #include <roughnessmap_fragment>\n    roughnessFactor = ".concat(R.roughness,";\n    ")}),W(ne,"".concat(R.metalness),{"#include <metalnessmap_fragment>":"\n    #include <metalnessmap_fragment>\n    metalnessFactor = ".concat(R.metalness,";\n    ")}),W(ne,"".concat(R.ao),{"#include <aomap_fragment>":"\n    #include <aomap_fragment>\n    reflectedLight.indirectDiffuse *= 1. - ".concat(R.ao,";\n    ")}),W(ne,"".concat(R.bump),{"#include <normal_fragment_maps>":"\n    #include <normal_fragment_maps>\n\n    vec3 csm_internal_orthogonal = ".concat(R.bump," - (dot(").concat(R.bump,", normal) * normal);\n    vec3 csm_internal_projectedbump = mat3(csm_internal_vModelViewMatrix) * csm_internal_orthogonal;\n    normal = normalize(normal - csm_internal_projectedbump);\n    ")}),W(ne,"".concat(R.depthAlpha),{"gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );":"\n      gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity * ".concat(R.depthAlpha," );\n    "),"gl_FragColor = packDepthToRGBA( fragCoordZ );":"\n      gl_FragColor = packDepthToRGBA( fragCoordZ );\n      gl_FragColor.a *= ".concat(R.depthAlpha,";\n    ")}),ne),Fn=(me={},W(me,"".concat(R.position),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":"\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( ".concat(R.position,", 1.0 );\n  ")}),W(me,"".concat(R.positionRaw),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":"\n    gl_Position = ".concat(R.position,";\n  ")}),W(me,"".concat(R.diffuseColor),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":"\n    gl_FragColor = ".concat(R.diffuseColor,";\n  ")}),W(me,"".concat(R.fragColor),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":"\n    gl_FragColor = ".concat(R.fragColor,";\n  ")}),me),Rn="\n\n#ifdef IS_VERTEX\n    // csm_Position & csm_PositionRaw\n    #ifdef IS_UNKNOWN\n        vec3 csm_Position = vec3(0.0);\n        vec4 csm_PositionRaw = vec4(0.0);\n        vec3 csm_Normal = vec3(0.0);\n    #else\n        vec3 csm_Position = position;\n        vec4 csm_PositionRaw = projectionMatrix * modelViewMatrix * vec4(position, 1.);\n        vec3 csm_Normal = normal;\n    #endif\n\n    // csm_PointSize\n    #ifdef IS_POINTSMATERIAL\n        float csm_PointSize = size;\n    #endif\n#else\n    // csm_DiffuseColor & csm_FragColor\n    #if defined IS_UNKNOWN || defined IS_SHADERMATERIAL || defined IS_MESHDEPTHMATERIAL || defined IS_MESHNORMALMATERIAL || defined IS_SHADOWMATERIAL\n        vec4 csm_DiffuseColor = vec4(1.0, 0.0, 1.0, 1.0);\n        vec4 csm_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    #else\n        #ifdef USE_MAP\n            vec4 _csm_sampledDiffuseColor = texture2D(map, vMapUv);\n\n            #ifdef DECODE_VIDEO_TEXTURE\n            // inline sRGB decode (TODO: Remove this code when https://crbug.com/1256340 is solved)\n            _csm_sampledDiffuseColor = vec4(mix(pow(_csm_sampledDiffuseColor.rgb * 0.9478672986 + vec3(0.0521327014), vec3(2.4)), _csm_sampledDiffuseColor.rgb * 0.0773993808, vec3(lessThanEqual(_csm_sampledDiffuseColor.rgb, vec3(0.04045)))), _csm_sampledDiffuseColor.w);\n            #endif\n\n            vec4 csm_DiffuseColor = vec4(diffuse, opacity) * _csm_sampledDiffuseColor;\n            vec4 csm_FragColor = vec4(diffuse, opacity) * _csm_sampledDiffuseColor;\n        #else\n            vec4 csm_DiffuseColor = vec4(diffuse, opacity);\n            vec4 csm_FragColor = vec4(diffuse, opacity);\n        #endif\n    #endif\n\n    // csm_Emissive, csm_Roughness, csm_Metalness\n    #if defined IS_MESHSTANDARDMATERIAL || defined IS_MESHPHYSICALMATERIAL\n        vec3 csm_Emissive = emissive;\n        float csm_Roughness = roughness;\n        float csm_Metalness = metalness;\n    #endif\n\n    // csm_AO\n    #if defined IS_MESHSTANDARDMATERIAL || defined IS_MESHPHYSICALMATERIAL || defined IS_MESHBASICMATERIAL || defined IS_MESHLAMBERTMATERIAL || defined IS_MESHPHONGMATERIAL || defined IS_MESHTOONMATERIAL\n        float csm_AO = 0.0;\n    #endif\n\n    // csm_Bump\n    #if defined IS_MESHLAMBERTMATERIAL || defined IS_MESHMATCAPMATERIAL || defined IS_MESHNORMALMATERIAL || defined IS_MESHPHONGMATERIAL || defined IS_MESHPHYSICALMATERIAL || defined IS_MESHSTANDARDMATERIAL || defined IS_MESHTOONMATERIAL || defined IS_SHADOWMATERIAL \n        vec3 csm_Bump = vec3(0.0);\n    #endif\n\n    float csm_DepthAlpha = 1.0;\n#endif\n",Nn="\n    varying mat4 csm_internal_vModelViewMatrix;\n",zn="\n    csm_internal_vModelViewMatrix = modelViewMatrix;\n",kn="\n    varying mat4 csm_internal_vModelViewMatrix;\n",Hn="\n    \n",re,Vn=(re={},W(re,"".concat(R.position),"*"),W(re,"".concat(R.positionRaw),"*"),W(re,"".concat(R.normal),"*"),W(re,"".concat(R.pointSize),["PointsMaterial"]),W(re,"".concat(R.diffuseColor),"*"),W(re,"".concat(R.fragColor),"*"),W(re,"".concat(R.emissive),["MeshStandardMaterial","MeshPhysicalMaterial"]),W(re,"".concat(R.roughness),["MeshStandardMaterial","MeshPhysicalMaterial"]),W(re,"".concat(R.metalness),["MeshStandardMaterial","MeshPhysicalMaterial"]),W(re,"".concat(R.ao),["MeshStandardMaterial","MeshPhysicalMaterial","MeshBasicMaterial","MeshLambertMaterial","MeshPhongMaterial","MeshToonMaterial"]),W(re,"".concat(R.bump),["MeshLambertMaterial","MeshMatcapMaterial","MeshNormalMaterial","MeshPhongMaterial","MeshPhysicalMaterial","MeshStandardMaterial","MeshToonMaterial","ShadowMaterial"]),W(re,"".concat(R.depthAlpha),"*"),re),Wn=["baseMaterial","fragmentShader","vertexShader","uniforms","patchMap","cacheKey","silent"],Gn=function(t,s,c){return t.split(s).join(c)},Yn=function(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},qn=function(t,s){return new RegExp("\\b".concat(Yn(s),"\\b")).test(t)};function Kn(d){try{new d}catch(t){if(t.message.indexOf("is not a constructor")>=0)return!1}return!0}function Xn(d,t){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Object.assign(d,t);var c=Object.getPrototypeOf(t);Object.entries(Object.getOwnPropertyDescriptors(c)).filter(function(o){var m=typeof o[1].get=="function",y=typeof o[1].set=="function",E=typeof o[1].value=="function",A=o[0]==="constructor";return(m||y||E)&&!A}).forEach(function(o){if(typeof d[o[0]]=="function"){s||console.warn("Function ".concat(o[0]," already exists on CSM, renaming to base_").concat(o[0]));var m="base_".concat(o[0]);d[m]=o[1].value.bind(d);return}Object.defineProperty(d,o[0],o[1])})}function $n(d){var t=d.toString().trim(),s=t.substring(t.indexOf("{")+1,t.lastIndexOf("}"));return s.trim().length===0}function ut(d){return d.replace(/\s/g,"")}function Jn(d,t,s){var c=d.lastIndexOf(t);return c===-1?d:d.substring(0,c)+s+d.substring(c+t.length)}var Zn=function(d){Ln(s,d);var t=jn(s);function s(c){var o,m=c.baseMaterial,y=c.fragmentShader,E=c.vertexShader,A=c.uniforms,C=c.patchMap,S=c.cacheKey,P=c.silent,N=Dn(c,Wn);Tn(this,s);var O;if(Kn(m)?O=new m(N):(O=m,Object.assign(O,N)),O.type==="RawShaderMaterial")throw new Error("CustomShaderMaterial does not support RawShaderMaterial");o=t.call(this),Xn(At(o),O,P),o.__csm={patchMap:C||{},fragmentShader:y||"",vertexShader:E||"",cacheKey:S,baseMaterial:m,instanceID:gt.generateUUID(),type:O.type,isAlreadyExtended:!$n(O.onBeforeCompile),cacheHash:"",silent:P},o.uniforms=he(he({},o.uniforms||{}),A||{});{var w=o.__csm,B=w.fragmentShader,h=w.vertexShader,M=o.uniforms;o.__csm.cacheHash=o.getCacheHash(),o.generateMaterial(B,h,M)}return o}return Bn(s,[{key:"update",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.uniforms=o.uniforms||this.uniforms,Object.assign(this.__csm,o);var m=this.__csm,y=m.fragmentShader,E=m.vertexShader,A=this.uniforms,C=this.getCacheHash();this.__csm.cacheHash=C,this.generateMaterial(y,E,A)}},{key:"clone",value:function(){var o={baseMaterial:this.__csm.baseMaterial,fragmentShader:this.__csm.fragmentShader,vertexShader:this.__csm.vertexShader,uniforms:this.uniforms,silent:this.__csm.silent,patchMap:this.__csm.patchMap,cacheKey:this.__csm.cacheKey},m=new this.constructor(o);return Object.assign(this,m),m}},{key:"getCacheHash",value:function(){var o=this.__csm,m=o.fragmentShader,y=o.vertexShader,E=this.uniforms,A=Object.values(E).reduce(function(S,P){var N=P.value;return S+JSON.stringify(N)},""),C=ut(m)+ut(y)+A;return C.trim().length>0?tn(C):this.customProgramCacheKey()}},{key:"generateMaterial",value:function(o,m,y){var E=this,A=this.parseShader(o),C=this.parseShader(m);this.uniforms=y||{},this.customProgramCacheKey=function(){return E.__csm.cacheHash};var S=function(O){try{if(A){var w=E.patchShader(A,O.fragmentShader,!0);O.fragmentShader=E.getMaterialDefine()+w}if(C){var B=E.patchShader(C,O.vertexShader);O.vertexShader="#define IS_VERTEX;\n"+B,O.vertexShader=E.getMaterialDefine()+O.vertexShader}O.uniforms=he(he({},O.uniforms),E.uniforms),E.uniforms=O.uniforms}catch(h){console.error(h)}};if(this.__csm.isAlreadyExtended){var P=this.onBeforeCompile;this.onBeforeCompile=function(N,O){P(N,O),S(N)}}else this.onBeforeCompile=S;this.needsUpdate=!0}},{key:"patchShader",value:function(o,m,y){var E=this,A=m,C=he(he({},this.getPatchMapForMaterial()),this.__csm.patchMap);Object.keys(C).forEach(function(N){Object.keys(C[N]).forEach(function(O){var w=Vn[N],B=E.__csm.type;if(N==="*"||qn(o.main,N))if(!w||Array.isArray(w)&&w.includes(B)||w==="*")A=Gn(A,O,C[N][O]);else throw new Error("CSM: ".concat(N," is not available in ").concat(B,". Shader cannot compile."))})}),A=A.replace("void main() {","\n        #ifndef CSM_IS_HEAD_DEFAULTS_DEFINED\n          ".concat(y?kn:Nn,"\n          #define CSM_IS_HEAD_DEFAULTS_DEFINED 1\n        #endif\n\n        ").concat(o.header,"\n        \n        void main() {\n          #ifndef CSM_IS_DEFAULTS_DEFINED\n            ").concat(Rn,"\n            #define CSM_IS_DEFAULTS_DEFINED 1\n          #endif\n          \n          #ifndef CSM_IS_MAIN_DEFAULTS_DEFINED\n            ").concat(y?Hn:zn,"\n            #define CSM_IS_MAIN_DEFAULTS_DEFINED 1\n          #endif\n\n          // CSM_START\n      "));var S=this.__csm.isAlreadyExtended,P=A.includes("// CSM_END");return S&&P?A=Jn(A,"// CSM_END","\n          // CSM_END\n          ".concat(o.main,"\n          // CSM_END\n        ")):A=A.replace("// CSM_START","\n        // CSM_START\n        ".concat(o.main,"\n        // CSM_END\n          ")),A=o.defines+A,A}},{key:"parseShader",value:function(o){if(o){var m=o.replace(/\/\*\*(.*?)\*\/|\/\/(.*?)\n/gm,""),y=bn(m),E=An(y),A=E.map(function(P){return P.name}).indexOf("main"),C=st(y.slice(0,A>=0?E[A].outer[0]:void 0)),S=A>=0?this.getShaderFromIndex(y,E[A].body):"";return{defines:"",header:C,main:S}}}},{key:"getMaterialDefine",value:function(){var o=this.__csm.type;return o?"#define IS_".concat(o.toUpperCase(),";\n"):"#define IS_UNKNOWN;\n"}},{key:"getPatchMapForMaterial",value:function(){switch(this.__csm.type){case"ShaderMaterial":return Fn;default:return Un}}},{key:"getShaderFromIndex",value:function(o,m){return st(o.slice(m[0],m[1]))}}]),s}(Dt);const Qn=["object"],er=We({__name:"buildingsModelCustomShader",props:{model:{},bulidingsColor:{default:"#e523ff"},landColor:{default:"#112233"},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(d){const t=d,s=wt(0),c=t.model.city;c.renderOrder=1001;const o=t.model.land,m=(A,C)=>{let S;A==="cu"||A==="land"&&(S=Array.isArray(o.material)?o.material:[o.material],S.forEach(P=>{P[C].setStyle(t.landColor),P.side=$e}))};(()=>{const{geometry:A}=c;A.computeBoundingBox(),A.computeBoundingSphere();const{max:C,min:S}=A.boundingBox,P=new Zn({baseMaterial:c.material,vertexShader:"\n		varying vec4 vPosition;\n		void main() {\n			vPosition = modelMatrix * vec4(position,1.0);\n			csm_Position = position * vec3(1.0);\n		}\n		",fragmentShader:"\n		uniform mat4 modelMatrix;\n		varying vec4 vPosition;\n		uniform vec3 uMax; \n		uniform vec3 uMin; \n		uniform float uOpacity;  \n		uniform float uBorderWidth; \n		uniform vec3 uLightColor;\n		uniform vec3 uColor;\n		uniform float uCircleTime; \n		uniform float uTime; \n		uniform vec3 uTopColor;					//\n		uniform bool uGradient;\n		vec4 uMax_world;\n		vec4 uMin_world;\n		void main() {\n			// \n			uMax_world =  modelMatrix * vec4(uMax,1.0);\n			uMin_world =  modelMatrix * vec4(uMin,1.0);\n			vec3 distColor = uColor;\n			float residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n			float rate = residue / uCircleTime;\n			float lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n			if (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n				csm_DiffuseColor = vec4(uLightColor, uOpacity);\n			} else {\n				csm_DiffuseColor = vec4(distColor, uOpacity);\n			}\n\n			//\n			if(uGradient){\n				float rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n				vec3 outColor = mix(distColor, uTopColor, rateHight*2.0);\n				csm_DiffuseColor = vec4(outColor, uOpacity);\n			}\n    }\n		",silent:!0,uniforms:{uMax:{value:C},uMin:{value:S},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new ve(t.bulidingsColor)},uOpacity:{value:t.opacity},uLightColor:{value:new ve("#ffffff")},uTopColor:{value:new ve("#ffff00")},uTime:s,uGradient:{value:t.gradient}},depthWrite:!0,depthTest:!0,transparent:!0,side:$e});c.material.dispose(),c.material=P})();const{onLoop:E}=zt();return E(({delta:A})=>{s.value+=A}),bt(()=>{t.bulidingsColor&&c.material.uniforms.uColor.value.setStyle(t.bulidingsColor),t.landColor&&m("land","color"),t.opacity&&(c.material.uniforms.uOpacity.value=t.opacity)}),Vt(t,(A,C)=>{c.material.uniforms.uGradient.value=A.gradient}),(A,C)=>(De(),Ge("primitive",{object:t.model.model.clone()},null,8,Qn))}}),ft=new Ve,Me=new ue;class Ct extends Tt{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const t=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],s=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],c=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(c),this.setAttribute("position",new Je(t,3)),this.setAttribute("uv",new Je(s,2))}applyMatrix4(t){const s=this.attributes.instanceStart,c=this.attributes.instanceEnd;return s!==void 0&&(s.applyMatrix4(t),c.applyMatrix4(t),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(t){let s;t instanceof Float32Array?s=t:Array.isArray(t)&&(s=new Float32Array(t));const c=new ze(s,6,1);return this.setAttribute("instanceStart",new ye(c,3,0)),this.setAttribute("instanceEnd",new ye(c,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(t){let s;t instanceof Float32Array?s=t:Array.isArray(t)&&(s=new Float32Array(t));const c=new ze(s,6,1);return this.setAttribute("instanceColorStart",new ye(c,3,0)),this.setAttribute("instanceColorEnd",new ye(c,3,3)),this}fromWireframeGeometry(t){return this.setPositions(t.attributes.position.array),this}fromEdgesGeometry(t){return this.setPositions(t.attributes.position.array),this}fromMesh(t){return this.fromWireframeGeometry(new Bt(t.geometry)),this}fromLineSegments(t){const s=t.geometry;return this.setPositions(s.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ve);const t=this.attributes.instanceStart,s=this.attributes.instanceEnd;t!==void 0&&s!==void 0&&(this.boundingBox.setFromBufferAttribute(t),ft.setFromBufferAttribute(s),this.boundingBox.union(ft))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new yt),this.boundingBox===null&&this.computeBoundingBox();const t=this.attributes.instanceStart,s=this.attributes.instanceEnd;if(t!==void 0&&s!==void 0){const c=this.boundingSphere.center;this.boundingBox.getCenter(c);let o=0;for(let m=0,y=t.count;m<y;m++)Me.fromBufferAttribute(t,m),o=Math.max(o,c.distanceToSquared(Me)),Me.fromBufferAttribute(s,m),o=Math.max(o,c.distanceToSquared(Me));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(t){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(t)}}Ce.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new Lt(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}};Ie.line={uniforms:vt.merge([Ce.common,Ce.fog,Ce.line]),vertexShader:"\n		#include <common>\n		#include <color_pars_vertex>\n		#include <fog_pars_vertex>\n		#include <logdepthbuf_pars_vertex>\n		#include <clipping_planes_pars_vertex>\n\n		uniform float linewidth;\n		uniform vec2 resolution;\n\n		attribute vec3 instanceStart;\n		attribute vec3 instanceEnd;\n\n		attribute vec3 instanceColorStart;\n		attribute vec3 instanceColorEnd;\n\n		#ifdef WORLD_UNITS\n\n			varying vec4 worldPos;\n			varying vec3 worldStart;\n			varying vec3 worldEnd;\n\n			#ifdef USE_DASH\n\n				varying vec2 vUv;\n\n			#endif\n\n		#else\n\n			varying vec2 vUv;\n\n		#endif\n\n		#ifdef USE_DASH\n\n			uniform float dashScale;\n			attribute float instanceDistanceStart;\n			attribute float instanceDistanceEnd;\n			varying float vLineDistance;\n\n		#endif\n\n		void trimSegment( const in vec4 start, inout vec4 end ) {\n\n			// trim end segment so it terminates between the camera plane and the near plane\n\n			// conservative estimate of the near plane\n			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n			float nearEstimate = - 0.5 * b / a;\n\n			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n			end.xyz = mix( start.xyz, end.xyz, alpha );\n\n		}\n\n		void main() {\n\n			#ifdef USE_COLOR\n\n				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n			#endif\n\n			#ifdef USE_DASH\n\n				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n				vUv = uv;\n\n			#endif\n\n			float aspect = resolution.x / resolution.y;\n\n			// camera space\n			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n			#ifdef WORLD_UNITS\n\n				worldStart = start.xyz;\n				worldEnd = end.xyz;\n\n			#else\n\n				vUv = uv;\n\n			#endif\n\n			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n			// perhaps there is a more elegant solution -- WestLangley\n\n			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n			if ( perspective ) {\n\n				if ( start.z < 0.0 && end.z >= 0.0 ) {\n\n					trimSegment( start, end );\n\n				} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n					trimSegment( end, start );\n\n				}\n\n			}\n\n			// clip space\n			vec4 clipStart = projectionMatrix * start;\n			vec4 clipEnd = projectionMatrix * end;\n\n			// ndc space\n			vec3 ndcStart = clipStart.xyz / clipStart.w;\n			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;\n\n			// direction\n			vec2 dir = ndcEnd.xy - ndcStart.xy;\n\n			// account for clip-space aspect ratio\n			dir.x *= aspect;\n			dir = normalize( dir );\n\n			#ifdef WORLD_UNITS\n\n				// get the offset direction as perpendicular to the view vector\n				vec3 worldDir = normalize( end.xyz - start.xyz );\n				vec3 offset;\n				if ( position.y < 0.5 ) {\n\n					offset = normalize( cross( start.xyz, worldDir ) );\n\n				} else {\n\n					offset = normalize( cross( end.xyz, worldDir ) );\n\n				}\n\n				// sign flip\n				if ( position.x < 0.0 ) offset *= - 1.0;\n\n				float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );\n\n				// don't extend the line if we're rendering dashes because we\n				// won't be rendering the endcaps\n				#ifndef USE_DASH\n\n					// extend the line bounds to encompass  endcaps\n					start.xyz += - worldDir * linewidth * 0.5;\n					end.xyz += worldDir * linewidth * 0.5;\n\n					// shift the position of the quad so it hugs the forward edge of the line\n					offset.xy -= dir * forwardOffset;\n					offset.z += 0.5;\n\n				#endif\n\n				// endcaps\n				if ( position.y > 1.0 || position.y < 0.0 ) {\n\n					offset.xy += dir * 2.0 * forwardOffset;\n\n				}\n\n				// adjust for linewidth\n				offset *= linewidth * 0.5;\n\n				// set the world position\n				worldPos = ( position.y < 0.5 ) ? start : end;\n				worldPos.xyz += offset;\n\n				// project the worldpos\n				vec4 clip = projectionMatrix * worldPos;\n\n				// shift the depth of the projected points so the line\n				// segments overlap neatly\n				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;\n				clip.z = clipPose.z * clip.w;\n\n			#else\n\n				vec2 offset = vec2( dir.y, - dir.x );\n				// undo aspect ratio adjustment\n				dir.x /= aspect;\n				offset.x /= aspect;\n\n				// sign flip\n				if ( position.x < 0.0 ) offset *= - 1.0;\n\n				// endcaps\n				if ( position.y < 0.0 ) {\n\n					offset += - dir;\n\n				} else if ( position.y > 1.0 ) {\n\n					offset += dir;\n\n				}\n\n				// adjust for linewidth\n				offset *= linewidth;\n\n				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n				offset /= resolution.y;\n\n				// select end\n				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n				// back to clip space\n				offset *= clip.w;\n\n				clip.xy += offset;\n\n			#endif\n\n			gl_Position = clip;\n\n			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n			#include <logdepthbuf_vertex>\n			#include <clipping_planes_vertex>\n			#include <fog_vertex>\n\n		}\n		",fragmentShader:"\n		uniform vec3 diffuse;\n		uniform float opacity;\n		uniform float linewidth;\n\n		#ifdef USE_DASH\n\n			uniform float dashOffset;\n			uniform float dashSize;\n			uniform float gapSize;\n\n		#endif\n\n		varying float vLineDistance;\n\n		#ifdef WORLD_UNITS\n\n			varying vec4 worldPos;\n			varying vec3 worldStart;\n			varying vec3 worldEnd;\n\n			#ifdef USE_DASH\n\n				varying vec2 vUv;\n\n			#endif\n\n		#else\n\n			varying vec2 vUv;\n\n		#endif\n\n		#include <common>\n		#include <color_pars_fragment>\n		#include <fog_pars_fragment>\n		#include <logdepthbuf_pars_fragment>\n		#include <clipping_planes_pars_fragment>\n\n		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {\n\n			float mua;\n			float mub;\n\n			vec3 p13 = p1 - p3;\n			vec3 p43 = p4 - p3;\n\n			vec3 p21 = p2 - p1;\n\n			float d1343 = dot( p13, p43 );\n			float d4321 = dot( p43, p21 );\n			float d1321 = dot( p13, p21 );\n			float d4343 = dot( p43, p43 );\n			float d2121 = dot( p21, p21 );\n\n			float denom = d2121 * d4343 - d4321 * d4321;\n\n			float numer = d1343 * d4321 - d1321 * d4343;\n\n			mua = numer / denom;\n			mua = clamp( mua, 0.0, 1.0 );\n			mub = ( d1343 + d4321 * ( mua ) ) / d4343;\n			mub = clamp( mub, 0.0, 1.0 );\n\n			return vec2( mua, mub );\n\n		}\n\n		void main() {\n\n			#include <clipping_planes_fragment>\n\n			#ifdef USE_DASH\n\n				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n			#endif\n\n			float alpha = opacity;\n\n			#ifdef WORLD_UNITS\n\n				// Find the closest points on the view ray and the line segment\n				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;\n				vec3 lineDir = worldEnd - worldStart;\n				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );\n\n				vec3 p1 = worldStart + lineDir * params.x;\n				vec3 p2 = rayEnd * params.y;\n				vec3 delta = p1 - p2;\n				float len = length( delta );\n				float norm = len / linewidth;\n\n				#ifndef USE_DASH\n\n					#ifdef USE_ALPHA_TO_COVERAGE\n\n						float dnorm = fwidth( norm );\n						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );\n\n					#else\n\n						if ( norm > 0.5 ) {\n\n							discard;\n\n						}\n\n					#endif\n\n				#endif\n\n			#else\n\n				#ifdef USE_ALPHA_TO_COVERAGE\n\n					// artifacts appear on some hardware if a derivative is taken within a conditional\n					float a = vUv.x;\n					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n					float len2 = a * a + b * b;\n					float dlen = fwidth( len2 );\n\n					if ( abs( vUv.y ) > 1.0 ) {\n\n						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );\n\n					}\n\n				#else\n\n					if ( abs( vUv.y ) > 1.0 ) {\n\n						float a = vUv.x;\n						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n						float len2 = a * a + b * b;\n\n						if ( len2 > 1.0 ) discard;\n\n					}\n\n				#endif\n\n			#endif\n\n			vec4 diffuseColor = vec4( diffuse, alpha );\n\n			#include <logdepthbuf_fragment>\n			#include <color_fragment>\n\n			gl_FragColor = vec4( diffuseColor.rgb, alpha );\n\n			#include <tonemapping_fragment>\n			#include <colorspace_fragment>\n			#include <fog_fragment>\n			#include <premultiplied_alpha_fragment>\n\n		}\n		"};class It extends _t{constructor(t){super({type:"LineMaterial",uniforms:vt.clone(Ie.line.uniforms),vertexShader:Ie.line.vertexShader,fragmentShader:Ie.line.fragmentShader,clipping:!0}),this.isLineMaterial=!0,this.setValues(t)}get color(){return this.uniforms.diffuse.value}set color(t){this.uniforms.diffuse.value=t}get worldUnits(){return"WORLD_UNITS"in this.defines}set worldUnits(t){t===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}get linewidth(){return this.uniforms.linewidth.value}set linewidth(t){this.uniforms.linewidth&&(this.uniforms.linewidth.value=t)}get dashed(){return"USE_DASH"in this.defines}set dashed(t){t===!0!==this.dashed&&(this.needsUpdate=!0),t===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}get dashScale(){return this.uniforms.dashScale.value}set dashScale(t){this.uniforms.dashScale.value=t}get dashSize(){return this.uniforms.dashSize.value}set dashSize(t){this.uniforms.dashSize.value=t}get dashOffset(){return this.uniforms.dashOffset.value}set dashOffset(t){this.uniforms.dashOffset.value=t}get gapSize(){return this.uniforms.gapSize.value}set gapSize(t){this.uniforms.gapSize.value=t}get opacity(){return this.uniforms.opacity.value}set opacity(t){this.uniforms&&(this.uniforms.opacity.value=t)}get resolution(){return this.uniforms.resolution.value}set resolution(t){this.uniforms.resolution.value.copy(t)}get alphaToCoverage(){return"USE_ALPHA_TO_COVERAGE"in this.defines}set alphaToCoverage(t){this.defines&&(t===!0!==this.alphaToCoverage&&(this.needsUpdate=!0),t===!0?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1))}}const dt=new ue,pt=new ue,J=new Be,Z=new Be,ae=new Be,Re=new ue,Ne=new Ot,Q=new Pt,ht=new ue,Ee=new Ve,Ae=new yt,se=new Be;let le,de;function mt(d,t,s){return se.set(0,0,-t,1).applyMatrix4(d.projectionMatrix),se.multiplyScalar(1/se.w),se.x=de/s.width,se.y=de/s.height,se.applyMatrix4(d.projectionMatrixInverse),se.multiplyScalar(1/se.w),Math.abs(Math.max(se.x,se.y))}function tr(d,t){const s=d.matrixWorld,c=d.geometry,o=c.attributes.instanceStart,m=c.attributes.instanceEnd,y=Math.min(c.instanceCount,o.count);for(let E=0,A=y;E<A;E++){Q.start.fromBufferAttribute(o,E),Q.end.fromBufferAttribute(m,E),Q.applyMatrix4(s);const C=new ue,S=new ue;le.distanceSqToSegment(Q.start,Q.end,S,C),S.distanceTo(C)<de*.5&&t.push({point:S,pointOnLine:C,distance:le.origin.distanceTo(S),object:d,face:null,faceIndex:E,uv:null,uv1:null})}}function nr(d,t,s){const c=t.projectionMatrix,m=d.material.resolution,y=d.matrixWorld,E=d.geometry,A=E.attributes.instanceStart,C=E.attributes.instanceEnd,S=Math.min(E.instanceCount,A.count),P=-t.near;le.at(1,ae),ae.w=1,ae.applyMatrix4(t.matrixWorldInverse),ae.applyMatrix4(c),ae.multiplyScalar(1/ae.w),ae.x*=m.x/2,ae.y*=m.y/2,ae.z=0,Re.copy(ae),Ne.multiplyMatrices(t.matrixWorldInverse,y);for(let N=0,O=S;N<O;N++){if(J.fromBufferAttribute(A,N),Z.fromBufferAttribute(C,N),J.w=1,Z.w=1,J.applyMatrix4(Ne),Z.applyMatrix4(Ne),J.z>P&&Z.z>P)continue;if(J.z>P){const v=J.z-Z.z,x=(J.z-P)/v;J.lerp(Z,x)}else if(Z.z>P){const v=Z.z-J.z,x=(Z.z-P)/v;Z.lerp(J,x)}J.applyMatrix4(c),Z.applyMatrix4(c),J.multiplyScalar(1/J.w),Z.multiplyScalar(1/Z.w),J.x*=m.x/2,J.y*=m.y/2,Z.x*=m.x/2,Z.y*=m.y/2,Q.start.copy(J),Q.start.z=0,Q.end.copy(Z),Q.end.z=0;const B=Q.closestPointToPointParameter(Re,!0);Q.at(B,ht);const h=gt.lerp(J.z,Z.z,B),M=h>=-1&&h<=1,I=Re.distanceTo(ht)<de*.5;if(M&&I){Q.start.fromBufferAttribute(A,N),Q.end.fromBufferAttribute(C,N),Q.start.applyMatrix4(y),Q.end.applyMatrix4(y);const v=new ue,x=new ue;le.distanceSqToSegment(Q.start,Q.end,x,v),s.push({point:x,pointOnLine:v,distance:le.origin.distanceTo(x),object:d,face:null,faceIndex:N,uv:null,uv1:null})}}}class rr extends jt{constructor(t=new Ct,s=new It({color:Math.random()*16777215})){super(t,s),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const t=this.geometry,s=t.attributes.instanceStart,c=t.attributes.instanceEnd,o=new Float32Array(2*s.count);for(let y=0,E=0,A=s.count;y<A;y++,E+=2)dt.fromBufferAttribute(s,y),pt.fromBufferAttribute(c,y),o[E]=E===0?0:o[E-1],o[E+1]=o[E]+dt.distanceTo(pt);const m=new ze(o,2,1);return t.setAttribute("instanceDistanceStart",new ye(m,1,0)),t.setAttribute("instanceDistanceEnd",new ye(m,1,1)),this}raycast(t,s){const c=this.material.worldUnits,o=t.camera;o===null&&!c&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const m=t.params.Line2!==void 0&&t.params.Line2.threshold||0;le=t.ray;const y=this.matrixWorld,E=this.geometry,A=this.material;de=A.linewidth+m,E.boundingSphere===null&&E.computeBoundingSphere(),Ae.copy(E.boundingSphere).applyMatrix4(y);let C;if(c)C=de*.5;else{const P=Math.max(o.near,Ae.distanceToPoint(le.origin));C=mt(o,P,A.resolution)}if(Ae.radius+=C,le.intersectsSphere(Ae)===!1)return;E.boundingBox===null&&E.computeBoundingBox(),Ee.copy(E.boundingBox).applyMatrix4(y);let S;if(c)S=de*.5;else{const P=Math.max(o.near,Ee.distanceToPoint(le.origin));S=mt(o,P,A.resolution)}Ee.expandByScalar(S),le.intersectsBox(Ee)!==!1&&(c?tr(this,s):nr(this,o,s))}}const ir=["object"],or=We({__name:"buildingsLines",props:{builds:{},width:{default:1},color:{default:"#FFF"},opacity:{default:1},style:{default:"Wireframe"}},setup(d){const t=d;let s=null,c=null;if(t.style==="Wireframe"){const o=new Ze(t.builds.geometry);let y=new Ct().fromEdgesGeometry(o),E=new It({color:t.color,linewidth:t.width,opacity:t.opacity,transparent:!0,depthWrite:!0,depthTest:!0});E.resolution.set(window.innerWidth,window.innerHeight),s=new rr(y,E),s.applyMatrix4(t.builds.matrix.clone())}else{c={transparent:!0,uniforms:{uColor:{value:new ve(t.color)},uOpacity:{value:t.opacity}},vertexShader:"\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:" \n        uniform vec3 uColor;\n				uniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      "};const o=new Ze(t.builds.geometry),m=new _t(c);s=new LineSegments(o,m),s.applyMatrix4(t.builds.matrix.clone()),s.material.linewidth=t.width,s.renderOrder=1e3}return bt(()=>{t.style==="Shader"&&(t.color&&(c.uniforms.uColor.value=new ve(t.color)),t.opacity&&(c.uniforms.uOpacity.value=t.opacity)),t.style==="Wireframe"&&(t.color&&(s.material.color=new ve(t.color)),t.opacity&&(s.material.opacity=t.opacity)),t.width&&(s.material.linewidth=t.width)}),(o,m)=>(De(),Ge("primitive",{object:ge(s)},null,8,ir))}}),ar=be("TresAmbientLight",{color:"#ffffff"},null,-1),sr=be("TresDirectionalLight",{position:[100,100,0],intensity:.5,color:"#ffffff"},null,-1),lr=be("TresAxesHelper",{args:[1e3],position:[0,19,0]},null,-1),cr=be("TresGridHelper",{args:[6e3,100],position:[0,19,0]},null,-1),hr=We({__name:"pagesShow",props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0}},async setup(d){let t,s;const c=d,o=Qe({clearColor:"#000000",shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:Ut,outputColorSpace:Ft,toneMapping:Rt}),m=Qe({autoRotate:c.autoRotate,enableDamping:!0});let y=null;c.showBuildings&&(y=([t,s]=Wt(()=>Qt()),t=await t,s(),t));const E=wt();return(A,C)=>(De(),Gt(ge(kt),qt(o,{"window-size":""}),{default:Yt(()=>[be("TresPerspectiveCamera",{ref_key:"perspectiveCameraRef",ref:E,position:[600,750,-1221],fov:45,near:1,far:1e4},null,512),je(ge(Ht),Kt(Xt(m)),null,16),ar,sr,c.showBuildings&&ge(y)?(De(),Ge($t,{key:0},[je(er,{model:ge(y)},null,8,["model"]),je(or,{builds:ge(y).city,color:"#000"},null,8,["builds"])],64)):Jt("",!0),Zt(A.$slots,"ability"),lr,cr]),_:3},16))}});export{Zn as C,hr as _,er as a,or as b,Qt as l};
